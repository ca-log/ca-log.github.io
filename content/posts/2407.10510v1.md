---
author: 'TechScribe'
title: '"TCM-FTP：利用大型语言模型微调技术革新中医处方预测"'
date: '2024-07-15'
Lastmod: '2024-07-16'
description: 'TCM-FTP: Fine-Tuning Large Language Models for Herbal Prescription Prediction'
categories:
  - CS.AI
# tags:
#   - emoji
---

[![TCM-FTP: Fine-Tuning Large Language Models for Herbal Prescription Prediction](https://arxiv-research-1301205113.cos.ap-guangzhou.myqcloud.com/images/2407.10510v1.pdf_0.jpg)](https://arxiv.org/abs/2407.10510v1)

## 摘要

本文介绍了一种名为TCM-FTP的新方法，用于通过微调大型语言模型（LLMs）来预测中药处方。该方法针对传统中医（TCM）中处方预测的技术挑战，特别是在高质量临床数据稀缺和症状与草药之间复杂关系的情况下。TCM-FTP利用从消化系统疾病专家那里收集的实际医疗记录构建了一个新的数据集DigestDS，并通过监督微调和低秩适应技术（LoRA）来提高计算效率。此外，通过在处方中随机排列草药来利用其顺序无关的特性进行数据增强。实验结果显示，TCM-FTP在预测草药和剂量方面显著优于现有方法，F1分数达到0.8031，剂量预测的归一化均方误差为0.0604。这表明微调LLMs对于TCM处方预测的重要性，并提供了一种有效的方法来实现这一点。<!--more-->

## 原理

TCM-FTP的工作原理基于对预训练的大型语言模型（LLMs）进行监督微调，以适应特定的TCM处方预测任务。通过使用低秩适应技术（LoRA），该方法在保持模型性能的同时，显著减少了需要调整的参数数量，从而提高了计算效率。此外，利用草药处方中草药顺序无关的特性，通过随机排列草药顺序进行数据增强，进一步提高了模型的泛化能力。具体来说，TCM-FTP通过最大化条件概率来训练模型，以预测给定症状描述下的草药及其剂量。这种方法通过将草药和剂量拼接成一个字符串，利用LLMs的自回归机制来生成预测。

## 流程

TCM-FTP的工作流程包括四个主要步骤：数据收集、数据预处理、模型微调和评估。首先，从中医医院的消化系统疾病部门收集实际的医疗记录。然后，进行数据预处理，包括去除不完整和隐私信息，保留关键的诊断和处方信息。接着，使用ShenNong LLM和LoRA技术对模型进行微调。最后，通过定量和定性评估指标来评估模型的性能，包括精确度、召回率、F1分数和归一化均方误差（NMSE）。例如，模型在DigestDS数据集上的F1分数达到0.8031，显示出其在实际应用中的高效性和准确性。

## 应用

TCM-FTP的应用前景广泛，特别是在中医临床实践中，可以帮助医生快速准确地生成处方，特别是在草药和剂量的预测上。此外，该方法还可以扩展到其他领域的处方预测，如西医处方预测，显示出其在医疗领域的广泛应用潜力。随着进一步的研究和优化，TCM-FTP有望成为中医临床决策支持系统的重要组成部分，提高医疗效率和患者满意度。